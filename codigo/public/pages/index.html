<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gerenciamento de Projetos</title>
    <link rel="stylesheet" href="../static/page1/main.css">

</head>

<body>
    <header class="header">
        <div class="header-left">
            <img src="" alt="Logo Esquerda" class="logo">
        </div>
        <div class="header-center">
            <h1>Sistema de Gerenciamento de Projetos</h1>
        </div>
        <div class="header-right">
            <img src="" alt="Logo Direita" class="logo">
        </div>
    </header>

    <!-- Barra de Navegação -->
    <nav class="navbar">
        <ul class="nav-list">
            <li><a href="#projetos">Projetos</a></li>
            <li><a href="#relatorios">Relatórios</a></li>
            <li><a href="#configuracoes">Configurações</a></li>
            <li><a href="#ajuda">Ajuda</a></li>
        </ul>
    </nav>

    <!-- Main html -->
    <main class="main-content">
        <div class="container">
            <!-- Botão para adicionar novo projeto - Chama addNewProject() do modules/interface.js -->
            <div class="add-project-section">
                <button class="btn btn-add" onclick="addNewProject()" id="add-project-btn">+ Adicionar Novo
                    Projeto</button>
            </div>

            <!-- Container de Projetos - Renderizado dinamicamente pelo JavaScript -->
            <!-- Projetos são carregados via loadProjectsFromServer() e renderizados com renderProjectFromData() -->
            <div id="projects-container">
                <!-- Primeiro projeto gerado por HTML - Serve como template inicial -->
                <!-- Projetos subsequentes são criados via createEmptyProject() -->
                <div class="project-block" data-project-id="" data-project-name="Projeto1">
                    <div class="project-header">
                        <!-- Botão minimizador - Chama toggleProject() do modules/interface.js -->
                        <button class="minimizer" onclick="toggleProject('Projeto1')">+</button>
                        <!-- Título editável - Chama makeEditable() do modules/edit.js -->
                        <h2 class="project-title editable-title" data-editable="true"
                            onclick="makeEditable(this, 'project')">Projeto1</h2>
                        <div class="project-actions">
                            <!-- Botão remover projeto - Chama deleteProject() do modules/projects.js -->
                            <button class="btn btn-delete" onclick="deleteProject('Projeto1')">Remover</button>
                        </div>
                    </div>
                    <!-- Conteúdo do projeto - Inicialmente colapsado -->
                    <!-- Expandido/recolhido via toggleElementVisibility() -->
                    <div class="project-content collapsed" id="project-content-Projeto1">
                        <!-- Sala1 inicial - Salas são criadas via createEmptyRoom() do modules/rooms.js -->
                        <div class="room-block" data-room-id="" data-room-name="Sala1">
                            <div class="room-header">
                                <!-- Botão minimizador da sala - Chama toggleRoom() do modules/interface.js -->
                                <button class="minimizer" onclick="toggleRoom('Projeto1-Sala1')">+</button>
                                <!-- Título editável da sala - Chama makeEditable() do modules/edit.js -->
                                <h3 class="room-title editable-title" data-editable="true"
                                    onclick="makeEditable(this, 'room')">Sala1</h3>
                                <!-- Botão remover sala - Chama deleteRoom() do modules/rooms.js -->
                                <button class="btn btn-delete-small"
                                    onclick="deleteRoom('Projeto1', 'Sala1')">Deletar</button>
                            </div>
                            <!-- Conteúdo da sala - Inicialmente colapsado -->
                            <div class="room-content collapsed" id="room-content-Projeto1-Sala1">
                                <!-- Seção de Climatização - Contém inputs e cálculos térmicos -->
                                <div class="section-block">
                                    <div class="section-header">
                                        <!-- Botão minimizador da seção - Chama toggleSection() do modules/interface.js -->
                                        <button class="minimizer"
                                            onclick="toggleSection('Projeto1-Sala1-clima')">+</button>
                                        <h4 class="section-title">Climatização</h4>
                                    </div>
                                    <div class="section-content collapsed" id="section-content-Projeto1-Sala1-clima">
                                        <!-- Subseção: Tabela de Inputs de Climatização -->
                                        <div class="subsection-block">
                                            <div class="subsection-header">
                                                <!-- Botão minimizador da subseção - Chama toggleSubsection() do modules/interface.js -->
                                                <button class="minimizer"
                                                    onclick="toggleSubsection('Projeto1-Sala1-clima-table')">+</button>
                                                <h5 class="subsection-title">Tabela de Inputs</h5>
                                            </div>
                                            <div class="subsection-content collapsed"
                                                id="subsection-content-Projeto1-Sala1-clima-table">
                                                <div class="clima-table">
                                                    <!-- Linha 1 - Dados básicos do ambiente -->
                                                    <!-- Todos os inputs têm data-field para identificação no extractRoomData() -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Ambiente:</label>
                                                            <input type="text" class="form-input clima-input"
                                                                data-field="ambiente"
                                                                placeholder="Ex: Sala de Servidores"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell">
                                                            <label>Back-up:</label>
                                                            <!-- Select de backup - também sincronizado com a tabela de capacidade -->
                                                            <select class="form-input clima-input" data-field="backup"
                                                                    onchange="calculateVazaoArAndThermalGains('Projeto1-Sala1')"> <!-- CORRIGIDO -->
                                                                <option value="">Selecione</option>
                                                                <option value="n">n</option>
                                                                <option value="n+1">n+1</option>
                                                                <option value="n+2">n+2</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <!-- Linha 2 - Dados de área e tipo de construção -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Área (m²):</label>
                                                            <input type="text" class="form-input clima-input"
                                                                data-field="area" placeholder="Ex: 50" step="0.01"
                                                                value="" onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell">
                                                            <label>Tipo de Construção:</label>
                                                            <select class="form-input clima-input"
                                                                data-field="tipoConstrucao"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                                <option value="">Selecione</option>
                                                                <option value="alvenaria">Alvenaria</option>
                                                                <option value="eletrocentro">Eletrocentro</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <!-- Linha 3 - Dimensões das paredes (Oeste e Leste) -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Parede Oeste (m):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="paredeOeste" placeholder="Ex: 5.5"
                                                                step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell">
                                                            <label>Parede Leste (m):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="paredeLeste" placeholder="Ex: 5.5"
                                                                step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                    </div>
                                                    <!-- Linha 4 - Dimensões das paredes (Norte e Sul) -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Parede Norte (m):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="paredeNorte" placeholder="Ex: 8.0"
                                                                step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell">
                                                            <label>Parede Sul (m):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="paredeSul" placeholder="Ex: 8.0" step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                    </div>
                                                    <!-- Linha 5 - Altura do pé direito -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Pé Direito (m):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="peDireito" placeholder="Ex: 3.0" step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell clima-cell-empty"></div>
                                                    </div>
                                                    <!-- Linha 6 - Divisórias para áreas não climatizadas -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Divisória Área Não Climatizada 1 (m²):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="divisoriaNaoClima1" placeholder="Ex: 10"
                                                                step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell">
                                                            <label>Divisória Área Não Climatizada 2 (m²):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="divisoriaNaoClima2" placeholder="Ex: 10"
                                                                step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                    </div>
                                                    <!-- Linha 7 - Divisórias para áreas climatizadas -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Divisória Área Climatizada 1 (m²):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="divisoriaClima1" placeholder="Ex: 15"
                                                                step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell">
                                                            <label>Divisória Área Climatizada 2 (m²):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="divisoriaClima2" placeholder="Ex: 15"
                                                                step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                    </div>
                                                    <!-- Linha 8 - Dissipação e número de pessoas -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Dissipação (W):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="dissipacao" placeholder="Ex: 5000"
                                                                step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell">
                                                            <label>N° Pessoas:</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="numPessoas" placeholder="Ex: 10" min="0"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                    </div>
                                                    <!-- Linha 9 - Quantidade de portas -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>N° Portas Duplas:</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="numPortasDuplas" placeholder="Ex: 2" min="0"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell">
                                                            <label>N° Portas Simples:</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="numPortasSimples" placeholder="Ex: 3"
                                                                min="0" onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                    </div>
                                                    <!-- Linha 10 - Pressurização e setpoint -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Pressurização (Pa):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="pressurizacao" placeholder="Ex: 50"
                                                                step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                        <div class="clima-cell">
                                                            <label>Setpoint (°C):</label>
                                                            <input type="number" class="form-input clima-input"
                                                                data-field="setpoint" placeholder="Ex: 22" step="0.01"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                        </div>
                                                    </div>
                                                    <!-- Linha 11 - Resultado do cálculo de vazão de ar -->
                                                    <!-- Atualizado por calculateVazaoAr() via updateElementText() -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell clima-cell-result">
                                                            <label>Vazão de Ar Externo (l/s):</label>
                                                            <div class="result-value-inline"
                                                                id="vazao-ar-Projeto1-Sala1">0</div>
                                                        </div>
                                                        <div class="clima-cell clima-cell-empty"></div>
                                                    </div>
                                                    <!-- Linha 12 - Sistema de combate a incêndio -->
                                                    <div class="clima-row">
                                                        <div class="clima-cell">
                                                            <label>Combate a Incêndio:</label>
                                                            <select class="form-input clima-input"
                                                                data-field="combateIncendio"
                                                                onchange="calculateVazaoAr('Projeto1-Sala1')">
                                                                <option value="">Selecione</option>
                                                                <option value="manual">manual</option>
                                                                <option value="fm200">fm200</option>
                                                                <option value="novec">novec</option>
                                                                <option value="firepro">firepro</option>
                                                                <option value="ni">ni</option>
                                                            </select>
                                                        </div>
                                                        <div class="clima-cell clima-cell-empty"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Subseção: Cálculo de Ganhos Térmicos -->
                                        <!-- Todos os valores são calculados por calculateThermalGains() -->
                                        <div class="subsection-block">
                                            <div class="subsection-header">
                                                <!-- adicionar botao de minimizar -->
                                                <button class="minimizer"
                                                    onclick="toggleSubsection('Projeto1-Sala1-ganhos-termicos')">+</button>
                                                <h5 class="subsection-title">Cálculo de Ganhos Térmicos</h5>
                                            </div>
                                            <div class="subsection-content collapsed"
                                                id="subsection-content-Projeto1-Sala1-ganhos-termicos">
                                                <!-- Summary Header - Resumo dos totais -->
                                                <div class="thermal-summary">
                                                    <span class="thermal-summary-item">
                                                        <strong>Total de Ganhos em W:</strong>
                                                        <span id="total-ganhos-w-Projeto1-Sala1"
                                                            class="thermal-value">0</span>
                                                    </span>
                                                    <span class="thermal-divider">|</span>
                                                    <span class="thermal-summary-item">
                                                        <strong>TR:</strong>
                                                        <span id="total-tr-Projeto1-Sala1"
                                                            class="thermal-value">0</span>
                                                    </span>
                                                </div>

                                                <!-- Tabela 1: Ganho de paredes e teto -->
                                                <!-- Valores calculados com base nas dimensões da sala -->
                                                <div class="thermal-table-container">
                                                    <h6 class="thermal-table-title">Ganho de paredes e teto</h6>
                                                    <table class="thermal-table">
                                                        <thead>
                                                            <tr>
                                                                <th>Elemento</th>
                                                                <th>Área (m²)</th>
                                                                <th>U-Value (W/m².K)</th>
                                                                <th>ΔT corrigido (°C)</th>
                                                                <th>Ganho Térmico (W)</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Teto</td>
                                                                <td id="area-teto-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-teto-Projeto1-Sala1">0</td>
                                                                <td id="deltat-teto-Projeto1-Sala1">0</td>
                                                                <td id="ganho-teto-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Parede Oeste</td>
                                                                <td id="area-parede-oeste-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-parede-oeste-Projeto1-Sala1">0</td>
                                                                <td id="deltat-parede-oeste-Projeto1-Sala1">0</td>
                                                                <td id="ganho-parede-oeste-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Parede Leste</td>
                                                                <td id="area-parede-leste-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-parede-leste-Projeto1-Sala1">0</td>
                                                                <td id="deltat-parede-leste-Projeto1-Sala1">0</td>
                                                                <td id="ganho-parede-leste-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Parede Norte</td>
                                                                <td id="area-parede-norte-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-parede-norte-Projeto1-Sala1">0</td>
                                                                <td id="deltat-parede-norte-Projeto1-Sala1">0</td>
                                                                <td id="ganho-parede-norte-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Parede Sul</td>
                                                                <td id="area-parede-sul-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-parede-sul-Projeto1-Sala1">0</td>
                                                                <td id="deltat-parede-sul-Projeto1-Sala1">0</td>
                                                                <td id="ganho-parede-sul-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr class="thermal-total-row">
                                                                <td colspan="4"><strong>Total Externo</strong></td>
                                                                <td id="total-externo-Projeto1-Sala1"><strong>0</strong>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <!-- Tabela 2: Ganho por divisórias -->
                                                <!-- Baseado nas áreas de divisória informadas -->
                                                <div class="thermal-table-container">
                                                    <h6 class="thermal-table-title">Ganho por divisórias</h6>
                                                    <table class="thermal-table">
                                                        <thead>
                                                            <tr>
                                                                <th>Elemento</th>
                                                                <th>Área (m²)</th>
                                                                <th>U-Value (W/m².K)</th>
                                                                <th>ΔT (°C)</th>
                                                                <th>Ganho Térmico (W)</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Divisória Não Climatizada 1</td>
                                                                <td id="area-divi-nc1-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-divi-nc1-Projeto1-Sala1">0</td>
                                                                <td id="deltat-divi-nc1-Projeto1-Sala1">0</td>
                                                                <td id="ganho-divi-nc1-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Divisória Não Climatizada 2</td>
                                                                <td id="area-divi-nc2-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-divi-nc2-Projeto1-Sala1">0</td>
                                                                <td id="deltat-divi-nc2-Projeto1-Sala1">0</td>
                                                                <td id="ganho-divi-nc2-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Divisória Climatizada 1</td>
                                                                <td id="area-divi-c1-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-divi-c1-Projeto1-Sala1">0</td>
                                                                <td id="deltat-divi-c1-Projeto1-Sala1">0</td>
                                                                <td id="ganho-divi-c1-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr>
                                                                <td>Divisória Climatizada 2</td>
                                                                <td id="area-divi-c2-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-divi-c2-Projeto1-Sala1">0</td>
                                                                <td id="deltat-divi-c2-Projeto1-Sala1">0</td>
                                                                <td id="ganho-divi-c2-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr class="thermal-total-row">
                                                                <td colspan="4"><strong>Total Divisões</strong></td>
                                                                <td id="total-divisoes-Projeto1-Sala1">
                                                                    <strong>0</strong>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <!-- Tabela 3: Ganho por piso -->
                                                <div class="thermal-table-container">
                                                    <h6 class="thermal-table-title">Ganho por piso</h6>
                                                    <table class="thermal-table">
                                                        <thead>
                                                            <tr>
                                                                <th>Elemento</th>
                                                                <th>Área (m²)</th>
                                                                <th>U-Value (W/m².K)</th>
                                                                <th>ΔT (°C)</th>
                                                                <th>Ganho Térmico (W)</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Piso</td>
                                                                <td id="area-piso-Projeto1-Sala1">0</td>
                                                                <td id="uvalue-piso-Projeto1-Sala1">0</td>
                                                                <td id="deltat-piso-Projeto1-Sala1">0</td>
                                                                <td id="ganho-piso-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr class="thermal-total-row">
                                                                <td colspan="4"><strong>Total Piso</strong></td>
                                                                <td id="total-piso-Projeto1-Sala1"><strong>0</strong>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <!-- Tabela 4: Ganho por iluminação -->
                                                <div class="thermal-table-container">
                                                    <h6 class="thermal-table-title">Ganho por iluminação</h6>
                                                    <table class="thermal-table">
                                                        <thead>
                                                            <tr>
                                                                <th>Elemento</th>
                                                                <th>Área (m²)</th>
                                                                <th>Fator (W/m²)</th>
                                                                <th>Fs</th>
                                                                <th>Ganho Térmico (W)</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Iluminação</td>
                                                                <td id="area-iluminacao-Projeto1-Sala1">0</td>
                                                                <td id="fator-iluminacao-Projeto1-Sala1">0</td>
                                                                <td id="fs-iluminacao-Projeto1-Sala1">0</td>
                                                                <td id="ganho-iluminacao-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr class="thermal-total-row">
                                                                <td colspan="4"><strong>Total Iluminação</strong></td>
                                                                <td id="total-iluminacao-Projeto1-Sala1">
                                                                    <strong>0</strong>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <!-- Tabela 5: Dissipação térmica interna -->
                                                <div class="thermal-table-container">
                                                    <h6 class="thermal-table-title">Dissipação térmica interna</h6>
                                                    <table class="thermal-table">
                                                        <thead>
                                                            <tr>
                                                                <th>Elemento</th>
                                                                <th>Fator Conversão</th>
                                                                <th>Pe (W)</th>
                                                                <th>Fs</th>
                                                                <th>Ganho Térmico (W)</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Dissipação Térmica Interna</td>
                                                                <td id="fator-conversao-dissi-Projeto1-Sala1">0</td>
                                                                <td id="pe-dissi-Projeto1-Sala1">0</td>
                                                                <td id="fs-dissi-Projeto1-Sala1">0</td>
                                                                <td id="ganho-dissi-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr class="thermal-total-row">
                                                                <td colspan="4"><strong>Total</strong></td>
                                                                <td id="total-dissi-Projeto1-Sala1"><strong>0</strong>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <!-- Tabela 6: Ganhos por ocupação de pessoas -->
                                                <div class="thermal-table-container">
                                                    <h6 class="thermal-table-title">Ganhos por ocupação de pessoas</h6>
                                                    <table class="thermal-table">
                                                        <thead>
                                                            <tr>
                                                                <th>Elemento</th>
                                                                <th>Csp</th>
                                                                <th>Clp</th>
                                                                <th>O</th>
                                                                <th>Fs</th>
                                                                <th>Ganho Térmico (W)</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Ocupação de Pessoas</td>
                                                                <td id="csp-pessoas-Projeto1-Sala1">0</td>
                                                                <td id="clp-pessoas-Projeto1-Sala1">0</td>
                                                                <td id="o-pessoas-Projeto1-Sala1">0</td>
                                                                <td id="fs-pessoas-Projeto1-Sala1">0</td>
                                                                <td id="ganho-pessoas-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr class="thermal-total-row">
                                                                <td colspan="5"><strong>Total Pessoas</strong></td>
                                                                <td id="total-pessoas-Projeto1-Sala1"><strong>0</strong>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <!-- Tabela 7: Ganho sensível de ar externo -->
                                                <div class="thermal-table-container">
                                                    <h6 class="thermal-table-title">Ganho sensível de ar externo</h6>
                                                    <table class="thermal-table">
                                                        <thead>
                                                            <tr>
                                                                <th>Elemento</th>
                                                                <th>m (kg)</th>
                                                                <th>c</th>
                                                                <th>ΔT (°C)</th>
                                                                <th>Ganho Térmico (W)</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Ar Sensível</td>
                                                                <td id="m-ar-sensivel-Projeto1-Sala1">0</td>
                                                                <td id="c-ar-sensivel-Projeto1-Sala1">0</td>
                                                                <td id="deltat-ar-sensivel-Projeto1-Sala1">0</td>
                                                                <td id="ganho-ar-sensivel-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr class="thermal-total-row">
                                                                <td colspan="4"><strong>Total Ar Sensível</strong></td>
                                                                <td id="total-ar-sensivel-Projeto1-Sala1">
                                                                    <strong>0</strong>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <!-- Tabela 8: Ganho latente de ar externo -->
                                                <div class="thermal-table-container">
                                                    <h6 class="thermal-table-title">Ganho latente de ar externo</h6>
                                                    <table class="thermal-table">
                                                        <thead>
                                                            <tr>
                                                                <th>Elemento</th>
                                                                <th>Var (l/s)</th>
                                                                <th>f</th>
                                                                <th>ΔUa (g/Kg)</th>
                                                                <th>Ganho Térmico (W)</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Ar Latente</td>
                                                                <td id="var-ar-latente-Projeto1-Sala1">0</td>
                                                                <td id="f-ar-latente-Projeto1-Sala1">0</td>
                                                                <td id="deltaua-ar-latente-Projeto1-Sala1">0</td>
                                                                <td id="ganho-ar-latente-Projeto1-Sala1">0</td>
                                                            </tr>
                                                            <tr class="thermal-total-row">
                                                                <td colspan="4"><strong>Total Ar Latente</strong></td>
                                                                <td id="total-ar-latente-Projeto1-Sala1">
                                                                    <strong>0</strong>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Seção de Máquinas - Gestão de equipamentos de climatização -->
                                <div class="section-block">
                                    <div class="section-header">
                                        <button class="minimizer" onclick="toggleSection('Projeto1-Sala1-maquinas')">+</button>
                                        <h4 class="section-title">Máquinas</h4>
                                        <!-- Botão para adicionar máquina - Chama addMachine() do modules/machineManagement.js -->
                                        <button class="btn btn-add-small" onclick="addMachine('Projeto1-Sala1')">+ Adicionar Máquina</button>
                                    </div>
                                    <div class="section-content collapsed" id="section-content-Projeto1-Sala1-maquinas">
                                        
                                        <!-- TABELA INTERATIVA DE CAPACIDADE DE REFRIGERAÇÃO -->
                                        <!-- Construída por buildCapacityCalculationTable() do modules/capacityCalculator.js -->
                                        <div class="capacity-calculation-table">
                                            <h5 class="table-title">Cálculo de Capacidade de Refrigeração</h5>
                                            <div class="table-container">
                                                <table class="thermal-capacity-table">
                                                    <thead>
                                                        <tr>
                                                            <th>Carga Estimada (TR)</th>
                                                            <th>Fator de Seg.</th>
                                                            <th>Cap. Unit. (TR)</th>
                                                            <th>Solução</th>
                                                            <th>Com back-up</th>
                                                            <th>TOTAL (TR)</th>
                                                            <th>FOLGA (%)</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <!-- Carga estimada baseada nos ganhos térmicos calculados -->
                                                            <td id="carga-estimada-Projeto1-Sala1">0</td>
                                                            <td>
                                                                <!-- Input do fator de segurança - Chama calculateCapacitySolution() -->
                                                                <input type="number" id="fator-seguranca-Projeto1-Sala1" step="0.01" 
                                                                    class="capacity-input" 
                                                                    onchange="calculateCapacitySolution('Projeto1-Sala1')"
                                                                    oninput="calculateCapacitySolution('Projeto1-Sala1')">
                                                            </td>
                                                            <td>
                                                                <!-- Seleção de capacidade unitária - Chama calculateCapacitySolution() -->
                                                                <select id="capacidade-unitaria-Projeto1-Sala1" class="capacity-select" 
                                                                        onchange="calculateCapacitySolution('Projeto1-Sala1')">
                                                                    <option value="1">1 TR</option>
                                                                    <option value="2">2 TR</option>
                                                                    <option value="3">3 TR</option>
                                                                    <option value="4">4 TR</option>
                                                                    <option value="5">5 TR</option>
                                                                    <option value="7.5">7.5 TR</option>
                                                                    <option value="10">10 TR</option>
                                                                    <option value="12.5">12.5 TR</option>
                                                                    <option value="15">15 TR</option>
                                                                    <option value="20">20 TR</option>
                                                                    <option value="25">25 TR</option>
                                                                    <option value="30">30 TR</option>
                                                                </select>
                                                            </td>
                                                            <!-- Solução calculada (número de unidades) -->
                                                            <td id="solucao-Projeto1-Sala1">0</td>
                                                            <td class="backup-cell">
                                                                <div class="backup-selection">
                                                                    <!-- Seleção de backup - Chama updateBackupConfiguration() do modules/capacityCalculator.js -->
                                                                    <!-- Sincronizado com o select de backup da seção de climatização -->
                                                                    <select class="backup-select" onchange="updateBackupConfiguration(this)">
                                                                        <option value="n" selected>n</option>
                                                                        <option value="n+1">n+1</option>
                                                                        <option value="n+2">n+2</option>
                                                                    </select>
                                                                </div>
                                                                <div class="backup-solution">
                                                                    <!-- Solução com backup aplicado -->
                                                                    <span id="solucao-backup-Projeto1-Sala1">0</span>
                                                                </div>
                                                            </td>
                                                            <!-- Total de capacidade calculado -->
                                                            <td id="total-capacidade-Projeto1-Sala1">0</td>
                                                            <!-- Folga percentual calculada -->
                                                            <td id="folga-Projeto1-Sala1">0%</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <!-- Container para máquinas de climatização -->
                                        <!-- Preenchido dinamicamente por addMachine() e loadSavedMachines() -->
                                        <div class="machines-container" id="machines-Projeto1-Sala1">
                                            <p class="empty-message">Nenhuma máquina adicionada ainda.</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Seção de Configuração - Opções de instalação -->
                                <div class="section-block">
                                    <div class="section-header">
                                        <button class="minimizer"
                                            onclick="toggleSection('Projeto1-Sala1-config')">+</button>
                                        <h4 class="section-title">Configuração de Instalação</h4>
                                    </div>
                                    <div class="section-content collapsed" id="section-content-Projeto1-Sala1-config">
                                        <div class="form-grid">
                                            <div class="form-group full-width">
                                                <label class="config-label">Opções de Instalação (selecione uma ou
                                                    mais):</label>
                                                <div class="checkbox-options-grid">
                                                    <div class="checkbox-column">
                                                        <!-- Checkboxes de opções de instalação -->
                                                        <!-- Coletados por extractRoomData() no modules/data-utils.js -->
                                                        <div class="checkbox-option">
                                                            <input type="checkbox" id="opcao1-Projeto1-Sala1"
                                                                name="opcoesInstalacao-Projeto1-Sala1"
                                                                value="bocal_insuflamento_protegido"
                                                                data-field="opcoesInstalacao">
                                                            <label for="opcao1-Projeto1-Sala1">Bocal de insuflamento
                                                                protegido por grelha diretamente no ambiente</label>
                                                        </div>
                                                        <div class="checkbox-option">
                                                            <input type="checkbox" id="opcao2-Projeto1-Sala1"
                                                                name="opcoesInstalacao-Projeto1-Sala1"
                                                                value="bocal_acoplado_dutos"
                                                                data-field="opcoesInstalacao">
                                                            <label for="opcao2-Projeto1-Sala1">Bocal acoplado à rede de
                                                                dutos por lona flexível. Distribuição por
                                                                grelhas</label>
                                                        </div>
                                                        <div class="checkbox-option">
                                                            <input type="checkbox" id="opcao3-Projeto1-Sala1"
                                                                name="opcoesInstalacao-Projeto1-Sala1"
                                                                value="condicionadores_externos_se"
                                                                data-field="opcoesInstalacao">
                                                            <label for="opcao3-Projeto1-Sala1">Condicionadores fixados
                                                                externamente à SE, sobre mão-francesa na parede</label>
                                                        </div>
                                                    </div>
                                                    <div class="checkbox-column">
                                                        <div class="checkbox-option">
                                                            <input type="checkbox" id="opcao4-Projeto1-Sala1"
                                                                name="opcoesInstalacao-Projeto1-Sala1"
                                                                value="evaporadoras_internas"
                                                                data-field="opcoesInstalacao">
                                                            <label for="opcao4-Projeto1-Sala1">Evaporadoras internas ao
                                                                ambiente climatizado</label>
                                                        </div>
                                                        <div class="checkbox-option">
                                                            <input type="checkbox" id="opcao5-Projeto1-Sala1"
                                                                name="opcoesInstalacao-Projeto1-Sala1"
                                                                value="evaporadoras_casa_maquinas"
                                                                data-field="opcoesInstalacao">
                                                            <label for="opcao5-Projeto1-Sala1">Evaporadoras em casa de
                                                                máquinas</label>
                                                        </div>
                                                        <div class="checkbox-option">
                                                            <input type="checkbox" id="opcao6-Projeto1-Sala1"
                                                                name="opcoesInstalacao-Projeto1-Sala1"
                                                                value="condensadores_externos"
                                                                data-field="opcoesInstalacao">
                                                            <label for="opcao6-Projeto1-Sala1">Condensadores fixados
                                                                externamente à sala elétrica</label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Botão para adicionar nova sala - Chama addNewRoom() do modules/rooms.js -->
                        <div class="add-room-section">
                            <button class="btn btn-add-secondary" onclick="addNewRoom('Projeto1')">+ Adicionar Nova
                                Sala</button>
                        </div>

                        <!-- Adicionado botão dinâmico que muda de "Salvar" para "Atualizar" -->
                        <!-- Construído por buildProjectActionsFooter() do modules/interface.js -->
                        <div class="project-actions-footer">
                            <!-- Botão para verificar dados - Chama verifyProjectData() do modules/projects.js -->
                            <button class="btn btn-verify" onclick="verifyProjectData('Projeto1')">Verificar
                                Dados</button>
                            <!-- Botão principal para salvar/atualizar - Chama saveProject() do modules/projects.js -->
                            <button class="btn btn-save project-save-btn" 
                                    onclick="saveProject('Projeto1', event)"
                                    data-project-name="Projeto1">
                                Salvar Projeto
                            </button>
                            <!-- Botões de exportação (funções não implementadas no código fornecido) -->
                            <button class="btn btn-download" onclick="downloadPDF('Projeto1')">Baixar PDF</button>
                            <button class="btn btn-download" onclick="downloadWord('Projeto1')">Baixar Word</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Script principal que inicializa todo o sistema -->
    <!-- Carrega módulos, constantes e projetos na inicialização -->
    <script type="module" src="../scripts/page1/main.js"></script>


</body>

</html>